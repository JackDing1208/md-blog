# 性能优化总结

## 常规方法

### DNS解析（尽量允许用缓存）：

- 域名预加载

### 减少HTTP请求次数（TCP连接很耗时间）：

- 接口优化
- JS、CSS文件数量合并
- websocket长连接
- 不要用太多个cookie

### 资源加载

- 图片懒加载——监听滚动事件，预先用data-src储存图片的src
- 图片预加载——使用JS提前加载图片

### CSS选择

- 优先外部CSS > style属性 > css in js 
- 使用性能较好的CSS属性实现效果，如transfrom animation
- 避免JS直接操作CSS引起reflow，考虑使用class作为状态机

### Script标签属性

- async 异步 谁先回来谁就先解析，不阻塞
- defer 异步 按照先后顺序（defer）解析，不阻塞
- script标签放在body下，防止操作dom引起多次重排重绘

### 缓存

- 文件打包带上hash方便使用  cache-control
- 结合实际情况使用协商缓存  e-tag last-modified
- 不重要的临时信息用localstorage存储

### React

- 减少dom节点 - 使用Fragment
- PureComponent - 定义好ShouldComponentUpdate
- 定义好props颗粒度，函数和对象作为props用useMemo封装
- 全局状态管理mobx，API简洁，性能好（redux会检查所有connect组件）
- 组件库懒加载
- 监听器、定时器记得移除

### RN

- 使用原生动画



## 特定场景——出现性能瓶颈后

- JSbundle分开打包
- SVG本地加载
- node中间件请求